values = c("#939184", "#ed4a89"))+
theme(legend.title = element_blank(),
legend.position = "inside",
legend.position.inside = c(0.8, 0.15),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"))
fig1
ggsave(filename = "figures/fig1-urban-burden.png", bg="white", width = 180, height = 140, units = "mm")
fig1 <- ggplot(fig1_data, aes(x=value, y=reorder(local_authority, -rowid)))+
theme_classic()+
geom_line(aes(group = local_authority))+
geom_point(aes(colour = benefit_type))+
labs(x = "Co-Benefits per Capita (GBP)", y = NULL,
subtitle = "Gross Potential vs. Net Gain per Capita across Scottish Local Authorities, 2025 to 2050")+
scale_color_manual(labels = c("Gross Potential = Benefits",
"Net Gain = Benefits - Costs"),
values = c("#939184", "#ed4a89"))+
theme(legend.title = element_blank(),
legend.position = "inside",
legend.position.inside = c(0.8, 0.15),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"))
fig1
fig1 <- ggplot(fig1_data, aes(x=value, y=reorder(local_authority, -rowid)))+
theme_classic()+
geom_line(aes(group = local_authority))+
geom_point(aes(colour = benefit_type))+
labs(x = "Co-Benefits per Capita (GBP)", y = NULL,
title = "Gross Potential vs. Net Gain per Capita across Scottish Local Authorities, 2025 to 2050")+
scale_color_manual(labels = c("Gross Potential = Benefits",
"Net Gain = Benefits - Costs"),
values = c("#939184", "#ed4a89"))+
theme(legend.title = element_blank(),
legend.position = "inside",
legend.position.inside = c(0.8, 0.15),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"))
fig1
net_benefit <- data3 %>%
select(small_area, local_authority, population, sum) %>%
group_by(local_authority) %>%
summarize(across(where(is.numeric), \(x) sum(x, na.rm = TRUE))) %>%
mutate(net_benefit = (sum/population)*1000000) %>%
select(-c(sum, population)) %>%
ungroup()
gross_benefit <- data3 %>%
mutate(sum_gross = select(., c(air_quality, dampness:excess_heat,
noise: physical_activity)) %>% rowSums(na.rm = TRUE)) %>%
select(small_area, local_authority, population, sum_gross) %>%
group_by(local_authority) %>%
summarize(across(where(is.numeric), \(x) sum(x, na.rm = TRUE))) %>%
mutate(gross_benefit = (sum_gross/population)*1000000) %>%
select(-c(sum_gross, population)) %>%
ungroup()
hassle_tax <- inner_join(gross_benefit, net_benefit) %>%
mutate(hassle_tax = gross_benefit - net_benefit) %>%
arrange(desc(hassle_tax))
fig1_data <- inner_join(gross_benefit, net_benefit) %>%
arrange(desc(net_benefit)) %>% rowid_to_column() %>%
pivot_longer(cols=c(gross_benefit, net_benefit), names_to = "benefit_type", values_to = "value")
fig1 <- ggplot(fig1_data, aes(x=value, y=reorder(local_authority, -rowid)))+
theme_classic()+
geom_line(aes(group = local_authority))+
geom_point(aes(colour = benefit_type))+
labs(x = "Co-Benefits per Capita (GBP)", y = NULL,
title = "Gross Potential vs. Net Gain per Capita across Scottish Local Authorities, 2025 to 2050")+
scale_color_manual(labels = c("Gross Potential = Benefits",
"Net Gain = Benefits - Costs"),
values = c("#939184", "#ed4a89"))+
theme(legend.title = element_blank(),
legend.position = "inside",
legend.position.inside = c(0.8, 0.15),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"))
fig1
ggsave(filename = "figures/fig1-urban-burden.png",
bg="white", width = 180, height = 140, units = "mm")
#######################
# fig1 with legend and title
fig1_legend <- fig1 +
labs(title = "Major Cities Benefit Less from Net Zero, But Pay Similar Hassle Tax",
subtitle = "Gross Potential vs. Net Gain per Capita across Scottish Local Authorities, 2025 to 2050",
caption = "Analysis across Scotland's 32 local authorities reveals that major cities like Glasgow and Edinburgh are positioned at the\nbottom of the 'Net Gain' rankings. These urban centers face lower per-capita co-benefit potential than car-dependent\ncommuter belts like Angus or East Renfrewshire, yet they pay a similar 'Hassle Tax', the economic\nand behavioural friction associated with complex infrastructure changes.")
fig1_legend
ggsave(filename = "figures/fig1-urban-burden-legend.png",
bg="white", width = 180, height = 140, units = "mm")
fig1 <- ggplot(fig1_data, aes(x=value, y=reorder(local_authority, -rowid)))+
theme_classic()+
geom_line(aes(group = local_authority))+
geom_point(aes(colour = benefit_type))+
labs(x = "Co-Benefits per Capita (GBP)", y = NULL,
title = "Gross Potential vs. Net Gain per Capita across Scottish Local Authorities, 2025 to 2050")+
scale_color_manual(labels = c("Gross Potential = Benefits",
"Net Gain = Benefits - Costs"),
values = c("#939184", "#ed4a89"))+
theme(legend.title = element_blank(),
legend.position = "inside",
legend.position.inside = c(0.8, 0.15),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"))
fig1
ggsave(filename = "figures/fig1-urban-burden.png",
bg="white", width = 210, height = 140, units = "mm")
#######################
# fig1 with legend and title
fig1_legend <- fig1 +
labs(title = "Major Cities Benefit Less from Net Zero, But Pay Similar Hassle Tax",
subtitle = "Gross Potential vs. Net Gain per Capita across Scottish Local Authorities, 2025 to 2050",
caption = "Analysis across Scotland's 32 local authorities reveals that major cities like Glasgow and Edinburgh are positioned at the\nbottom of the 'Net Gain' rankings. These urban centers face lower per-capita co-benefit potential than car-dependent\ncommuter belts like Angus or East Renfrewshire, yet they pay a similar 'Hassle Tax', the economic\nand behavioural friction associated with complex infrastructure changes.")
fig1_legend
ggsave(filename = "figures/fig1-urban-burden-legend.png",
bg="white", width = 210, height = 140, units = "mm")
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "white"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Improved Air Quality", "Reduced Noise",
"Increased Physical Activity"),
values = c("#fbb61a", "#ed4a89", "#35b779", "#21918c", "#31688e"))+
labs(title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
data_fig2 <- data3 %>%
filter(local_authority %in% LA) %>%
select(local_authority, population, physical_activity,
air_quality, noise, excess_cold, diet_change) %>%
group_by(local_authority) %>%
summarize(across(where(is.numeric), \(x) sum(x, na.rm = TRUE))) %>%
rowwise() %>%
mutate(activity_weighted = (physical_activity/population)*1000000,
air_weighted = (air_quality/population)*1000000,
noise_weighted = (noise/population)*1000000,
cold_weighted = (excess_cold/population)*1000000,
diet_weighted = (diet_change/population)*1000000) %>%
select(-c(population, physical_activity, air_quality, noise, excess_cold, diet_change)) %>%
pivot_longer(cols = c(activity_weighted, air_weighted, noise_weighted, cold_weighted, diet_weighted),
names_to = "co_benefit", values_to = "weighted") %>%
mutate(weighted = round(weighted))%>%
mutate(divider = case_when(local_authority %in% top3 ~ "Top 3 Beneficiaries",
local_authority %in% bottom3 ~ "Bottom 3 Beneficiaries"))
# present top 3 and bottom 3 beneficiaries
LA <- c("Angus", "East Renfrewshire", "East Dunbartonshire",
"Glasgow City", "Moray", "Scottish Borders")
top3 <- c("Angus", "East Renfrewshire", "East Dunbartonshire")
bottom3 <- c("Glasgow City", "Moray", "Scottish Borders")
data_fig2 <- data3 %>%
filter(local_authority %in% LA) %>%
select(local_authority, population, physical_activity,
air_quality, noise, excess_cold, diet_change) %>%
group_by(local_authority) %>%
summarize(across(where(is.numeric), \(x) sum(x, na.rm = TRUE))) %>%
rowwise() %>%
mutate(activity_weighted = (physical_activity/population)*1000000,
air_weighted = (air_quality/population)*1000000,
noise_weighted = (noise/population)*1000000,
cold_weighted = (excess_cold/population)*1000000,
diet_weighted = (diet_change/population)*1000000) %>%
select(-c(population, physical_activity, air_quality, noise, excess_cold, diet_change)) %>%
pivot_longer(cols = c(activity_weighted, air_weighted, noise_weighted, cold_weighted, diet_weighted),
names_to = "co_benefit", values_to = "weighted") %>%
mutate(weighted = round(weighted))%>%
mutate(divider = case_when(local_authority %in% top3 ~ "Top 3 Beneficiaries",
local_authority %in% bottom3 ~ "Bottom 3 Beneficiaries"))
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 3, position = position_stack(vjust = 0.5))+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "white"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Improved Air Quality", "Reduced Noise",
"Increased Physical Activity"),
values = c("#fbb61a", "#ed4a89", "#35b779", "#21918c", "#31688e"))+
labs(title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
ggsave(filename = "figures/fig2-proportion-benefits.png", bg="white",
width = 180, height = 120, units = "mm")
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 3, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Improved Air Quality", "Reduced Noise",
"Increased Physical Activity"),
values = c("#fbb61a", "#ed4a89", "#35b779", "#21918c", "#31688e"))+
labs(title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 3, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Improved Air Quality", "Reduced Noise",
"Increased Physical Activity"),
values = c("#fbb61a", "#ed4a89", "#35b779", "#21918c", "#31688e"))+
labs(ylab = "Co-Benefits per Capita (GBP)",
title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 3, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Improved Air Quality", "Reduced Noise",
"Increased Physical Activity"),
values = c("#fbb61a", "#ed4a89", "#35b779", "#21918c", "#31688e"))+
labs(y = "Co-Benefits per Capita (GBP)",
title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
ggsave(filename = "figures/fig2-proportion-benefits.png", bg="white",
width = 210, height = 120, units = "mm")
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 2.5, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Improved Air Quality", "Reduced Noise",
"Increased Physical Activity"),
values = c("#fbb61a", "#ed4a89", "#35b779", "#21918c", "#31688e"))+
labs(y = "Co-Benefits per Capita (GBP)",
title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
ggsave(filename = "figures/fig2-proportion-benefits.png", bg="white",
width = 210, height = 120, units = "mm")
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 2.5, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Improved Air Quality", "Reduced Noise",
"Increased Physical Activity"),
values = c("#cf4446", "#ed4a89", "#26828e", "#31688e", "#3e4989"))+
labs(y = "Co-Benefits per Capita (GBP)",
title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
data_fig2$local_authority <-
gsub("East Renfrewshire", "East\nRenfrewshire", data_fig2$local_authority)
data_fig2$local_authority <-
gsub("East Dunbartonshire", "East\nDunbartonshire", data_fig2$local_authority)
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 2.5, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Improved Air Quality", "Reduced Noise",
"Increased Physical Activity"),
values = c("#ed6925", "#ed4a89", "#26828e", "#31688e", "#3e4989"))+
labs(y = "Co-Benefits per Capita (GBP)",
title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 2.5, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Reduced Excess Cold",
"Air Quality", "Reduced Noise",
"Physical Activity"),
values = c("#ed6925", "#ed4a89", "#26828e", "#31688e", "#3e4989"))+
labs(y = "Co-Benefits per Capita (GBP)",
title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 2.5, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Excess Cold Reduction",
"Air Quality", "Noise Reduction",
"Physical Activity"),
values = c("#ed6925", "#ed4a89", "#26828e", "#31688e", "#3e4989"))+
labs(y = "Co-Benefits per Capita (GBP)",
title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
data_fig2 <- data3 %>%
filter(local_authority %in% LA) %>%
select(local_authority, population, physical_activity,
air_quality, noise, excess_cold, diet_change) %>%
group_by(local_authority) %>%
summarize(across(where(is.numeric), \(x) sum(x, na.rm = TRUE))) %>%
rowwise() %>%
mutate(activity_weighted = (physical_activity/population)*1000000,
air_weighted = (air_quality/population)*1000000,
noise_weighted = (noise/population)*1000000,
cold_weighted = (excess_cold/population)*1000000,
diet_weighted = (diet_change/population)*1000000) %>%
select(-c(population, physical_activity, air_quality, noise, excess_cold, diet_change)) %>%
pivot_longer(cols = c(activity_weighted, air_weighted, noise_weighted, cold_weighted, diet_weighted),
names_to = "co_benefit", values_to = "weighted") %>%
mutate(weighted = round(weighted))%>%
mutate(divider = case_when(local_authority %in% top3 ~ "Top 3 Local Authorities",
local_authority %in% bottom3 ~ "Bottom 3 Local Authorities"))
data_fig2$local_authority <-
gsub("East Renfrewshire", "East\nRenfrewshire", data_fig2$local_authority)
data_fig2$local_authority <-
gsub("East Dunbartonshire", "East\nDunbartonshire", data_fig2$local_authority)
data_fig2$divider <- factor(data_fig2$divider,
levels = c("Top 3 Local Authorities", "Bottom 3 Local Authorities"))
fig2 <-ggplot(data_fig2, aes(y=weighted, x=local_authority,
fill = reorder(co_benefit, weighted),label = weighted)) +
theme_classic()+
geom_bar(stat = "identity", position = "stack") +
geom_text(size = 2.5, position = position_stack(vjust = 0.5), color="white")+
facet_grid(~divider, scales = "free", space = "free") +
theme(axis.title.x = element_blank(),
#axis.title.y = element_blank(),
legend.title = element_blank(),
plot.title.position =  "plot" ,
plot.caption.position =  "plot",
text = element_text(color = "#3b3a34"),
plot.caption = element_text(hjust = 0, color = "#706e63"),
plot.background = element_rect(fill = "#f6f5f4",color = NA),
plot.margin = unit(c(.5, .5, .2, .5), "cm"),
legend.background = element_rect(fill = "#f6f5f4",color = NA),
panel.background = element_rect(fill = "#f6f5f4",color = NA),
strip.background = element_rect(fill = "#f6f5f4",color = NA))+
scale_fill_manual(labels = c("Diet Change", "Excess Cold Reduction",
"Air Quality", "Noise Reduction",
"Physical Activity"),
values = c("#ed6925", "#ed4a89", "#26828e", "#31688e", "#3e4989"))+
labs(y = "Co-Benefits per Capita (GBP)",
title = "The Composition Gap: Why Cities Lag",
subtitle = "Per Capita Gain for the 5 strongest Co-Benefits in the Top and Bottom Beneficiaries, 2025 to 2050",
caption = "The disparity in potential is driven by baseline behaviors. High-gain areas benefit from massive shifts away from car dependency, translating into high scores for physical activity and air quality. In cities where public transport use is already higher, the 'delta' for improvement is smaller, making the transition high-effort but relatively lower-reward on a per-person basis.")
fig2
ggsave(filename = "figures/fig2-proportion-benefits.png", bg="white",
width = 210, height = 120, units = "mm")
